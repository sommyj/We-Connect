{"version":3,"sources":["reviews.js"],"names":["model","Review","reviewsController","create","req","res","body","response","userId","businessId","status","send","message","params","then","review","catch","error","list","findAll","where","reviews","update","findById","reviewId","reviewUpdate","destroy"],"mappings":"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","file":"reviews.js","sourceRoot":"/home/somto/1Projects/Andela/We-Connect/server/server/controllers","sourcesContent":["import model from '../models';\n\nconst [Review] = [model.Review];\n\nconst reviewsController = {\n  create(req, res) {\n    if (!req.body.response || !req.body.userId || !req.body.businessId) {\n      return res.status(206).send({ message: 'Incomplete field' });\n    }\n\n    return Review\n      .create({\n        response: req.body.response,\n        userId: req.body.userId,\n        businessId: req.params.businessId,\n      })\n      .then(review => res.status(201).send(review))\n      .catch(error => res.status(400).send(error));\n  },\n  list(req, res) {\n    return Review\n      .findAll({ where: { businessId: req.params.businessId } })\n      .then(reviews => res.status(200).send(reviews))\n      .catch(error => res.status(400).send(error));\n  },\n  update(req, res) {\n    return Review\n      .findById(req.params.reviewId)\n      .then((review) => {\n        if (!review) {\n          return res.status(404).send({ message: 'Review not found' });\n        }\n        if (review.userId !== req.body.userId) {\n          return res.status(400).send({ message: 'User can not be altered' });\n        }\n        if (review.businessId !== req.body.businessId) {\n          return res.status(400).send({ message: 'Business can not be altered' });\n        }\n        return review\n          .update({\n            response: req.body.response || review.response,\n            userId: req.body.userId || review.userId,\n            businessId: req.params.businessId,\n          })\n          .then(reviewUpdate => res.status(200).send(reviewUpdate))\n          .catch(error => res.status(400).send(error));\n      }).catch(error => res.status(400).send(error));\n  },\n  destroy(req, res) {\n    return Review\n      .findById(req.params.reviewId)\n      .then((review) => {\n        if (!review) {\n          return res.status(404).send({ message: 'Review not found' });\n        }\n        return review\n          .destroy()\n          .then(() => res.status(204).send())\n          .catch(error => res.status(400).send(error));\n      }).catch(error => res.status(400).send(error));\n  },\n\n};\n\nexport default reviewsController;\n"]}