'use strict';var cov_fkfq7rize=function(){var path="/home/somto/Andela/We-Connect/server/server/controllers/reviews.js",hash="8e63420ac07022a0dab6e17a7b9f94e69b9ecb31",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/somto/Andela/We-Connect/server/server/controllers/reviews.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:14},end:{line:7,column:34}},"2":{start:{line:9,column:15},end:{line:9,column:46}},"3":{start:{line:11,column:39},end:{line:11,column:93}},"4":{start:{line:13,column:13},end:{line:13,column:36}},"5":{start:{line:15,column:24},end:{line:76,column:1}},"6":{start:{line:17,column:4},end:{line:19,column:5}},"7":{start:{line:18,column:6},end:{line:18,column:67}},"8":{start:{line:21,column:4},end:{line:29,column:7}},"9":{start:{line:26,column:6},end:{line:26,column:42}},"10":{start:{line:28,column:6},end:{line:28,column:41}},"11":{start:{line:32,column:4},end:{line:36,column:7}},"12":{start:{line:33,column:6},end:{line:33,column:43}},"13":{start:{line:35,column:6},end:{line:35,column:41}},"14":{start:{line:39,column:4},end:{line:60,column:7}},"15":{start:{line:40,column:6},end:{line:42,column:7}},"16":{start:{line:41,column:8},end:{line:41,column:69}},"17":{start:{line:43,column:6},end:{line:45,column:7}},"18":{start:{line:44,column:8},end:{line:44,column:76}},"19":{start:{line:46,column:6},end:{line:48,column:7}},"20":{start:{line:47,column:8},end:{line:47,column:80}},"21":{start:{line:49,column:6},end:{line:57,column:9}},"22":{start:{line:54,column:8},end:{line:54,column:44}},"23":{start:{line:56,column:8},end:{line:56,column:43}},"24":{start:{line:59,column:6},end:{line:59,column:41}},"25":{start:{line:63,column:4},end:{line:74,column:7}},"26":{start:{line:64,column:6},end:{line:66,column:7}},"27":{start:{line:65,column:8},end:{line:65,column:69}},"28":{start:{line:67,column:6},end:{line:71,column:9}},"29":{start:{line:68,column:8},end:{line:68,column:38}},"30":{start:{line:70,column:8},end:{line:70,column:43}},"31":{start:{line:73,column:6},end:{line:73,column:41}},"32":{start:{line:78,column:0},end:{line:78,column:36}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:11,column:9},end:{line:11,column:31}},loc:{start:{line:11,column:37},end:{line:11,column:95}},line:11},"1":{name:"create",decl:{start:{line:16,column:19},end:{line:16,column:25}},loc:{start:{line:16,column:36},end:{line:30,column:3}},line:16},"2":{name:"(anonymous_2)",decl:{start:{line:25,column:12},end:{line:25,column:13}},loc:{start:{line:25,column:30},end:{line:27,column:5}},line:25},"3":{name:"(anonymous_3)",decl:{start:{line:27,column:13},end:{line:27,column:14}},loc:{start:{line:27,column:30},end:{line:29,column:5}},line:27},"4":{name:"list",decl:{start:{line:31,column:17},end:{line:31,column:21}},loc:{start:{line:31,column:32},end:{line:37,column:3}},line:31},"5":{name:"(anonymous_5)",decl:{start:{line:32,column:81},end:{line:32,column:82}},loc:{start:{line:32,column:100},end:{line:34,column:5}},line:32},"6":{name:"(anonymous_6)",decl:{start:{line:34,column:13},end:{line:34,column:14}},loc:{start:{line:34,column:30},end:{line:36,column:5}},line:34},"7":{name:"update",decl:{start:{line:38,column:19},end:{line:38,column:25}},loc:{start:{line:38,column:36},end:{line:61,column:3}},line:38},"8":{name:"(anonymous_8)",decl:{start:{line:39,column:53},end:{line:39,column:54}},loc:{start:{line:39,column:71},end:{line:58,column:5}},line:39},"9":{name:"(anonymous_9)",decl:{start:{line:53,column:14},end:{line:53,column:15}},loc:{start:{line:53,column:32},end:{line:55,column:7}},line:53},"10":{name:"(anonymous_10)",decl:{start:{line:55,column:15},end:{line:55,column:16}},loc:{start:{line:55,column:32},end:{line:57,column:7}},line:55},"11":{name:"(anonymous_11)",decl:{start:{line:58,column:13},end:{line:58,column:14}},loc:{start:{line:58,column:30},end:{line:60,column:5}},line:58},"12":{name:"destroy",decl:{start:{line:62,column:20},end:{line:62,column:27}},loc:{start:{line:62,column:38},end:{line:75,column:3}},line:62},"13":{name:"(anonymous_13)",decl:{start:{line:63,column:53},end:{line:63,column:54}},loc:{start:{line:63,column:71},end:{line:72,column:5}},line:63},"14":{name:"(anonymous_14)",decl:{start:{line:67,column:35},end:{line:67,column:36}},loc:{start:{line:67,column:47},end:{line:69,column:7}},line:67},"15":{name:"(anonymous_15)",decl:{start:{line:69,column:15},end:{line:69,column:16}},loc:{start:{line:69,column:32},end:{line:71,column:7}},line:69},"16":{name:"(anonymous_16)",decl:{start:{line:72,column:13},end:{line:72,column:14}},loc:{start:{line:72,column:30},end:{line:74,column:5}},line:72}},branchMap:{"0":{loc:{start:{line:11,column:46},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:70},end:{line:11,column:73}},{start:{line:11,column:76},end:{line:11,column:92}}],line:11},"1":{loc:{start:{line:11,column:46},end:{line:11,column:67}},type:"binary-expr",locations:[{start:{line:11,column:46},end:{line:11,column:49}},{start:{line:11,column:53},end:{line:11,column:67}}],line:11},"2":{loc:{start:{line:17,column:4},end:{line:19,column:5}},type:"if",locations:[{start:{line:17,column:4},end:{line:19,column:5}},{start:{line:17,column:4},end:{line:19,column:5}}],line:17},"3":{loc:{start:{line:17,column:8},end:{line:17,column:70}},type:"binary-expr",locations:[{start:{line:17,column:8},end:{line:17,column:26}},{start:{line:17,column:30},end:{line:17,column:46}},{start:{line:17,column:50},end:{line:17,column:70}}],line:17},"4":{loc:{start:{line:40,column:6},end:{line:42,column:7}},type:"if",locations:[{start:{line:40,column:6},end:{line:42,column:7}},{start:{line:40,column:6},end:{line:42,column:7}}],line:40},"5":{loc:{start:{line:43,column:6},end:{line:45,column:7}},type:"if",locations:[{start:{line:43,column:6},end:{line:45,column:7}},{start:{line:43,column:6},end:{line:45,column:7}}],line:43},"6":{loc:{start:{line:46,column:6},end:{line:48,column:7}},type:"if",locations:[{start:{line:46,column:6},end:{line:48,column:7}},{start:{line:46,column:6},end:{line:48,column:7}}],line:46},"7":{loc:{start:{line:50,column:18},end:{line:50,column:54}},type:"binary-expr",locations:[{start:{line:50,column:18},end:{line:50,column:35}},{start:{line:50,column:39},end:{line:50,column:54}}],line:50},"8":{loc:{start:{line:51,column:16},end:{line:51,column:48}},type:"binary-expr",locations:[{start:{line:51,column:16},end:{line:51,column:31}},{start:{line:51,column:35},end:{line:51,column:48}}],line:51},"9":{loc:{start:{line:64,column:6},end:{line:66,column:7}},type:"if",locations:[{start:{line:64,column:6},end:{line:66,column:7}},{start:{line:64,column:6},end:{line:66,column:7}}],line:64}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_fkfq7rize.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _models=(cov_fkfq7rize.s[1]++,require('../models'));var _models2=(cov_fkfq7rize.s[2]++,_interopRequireDefault(_models));function _interopRequireDefault(obj){cov_fkfq7rize.f[0]++;cov_fkfq7rize.s[3]++;return(cov_fkfq7rize.b[1][0]++,obj)&&(cov_fkfq7rize.b[1][1]++,obj.__esModule)?(cov_fkfq7rize.b[0][0]++,obj):(cov_fkfq7rize.b[0][1]++,{default:obj});}var Review=(cov_fkfq7rize.s[4]++,_models2.default.Review);var reviewsController=(cov_fkfq7rize.s[5]++,{create:function create(req,res){cov_fkfq7rize.f[1]++;cov_fkfq7rize.s[6]++;if((cov_fkfq7rize.b[3][0]++,!req.body.response)||(cov_fkfq7rize.b[3][1]++,!req.body.userId)||(cov_fkfq7rize.b[3][2]++,!req.body.businessId)){cov_fkfq7rize.b[2][0]++;cov_fkfq7rize.s[7]++;return res.status(206).send({message:'Incomplete field'});}else{cov_fkfq7rize.b[2][1]++;}cov_fkfq7rize.s[8]++;return Review.create({response:req.body.response,userId:req.body.userId,businessId:req.params.businessId}).then(function(review){cov_fkfq7rize.f[2]++;cov_fkfq7rize.s[9]++;return res.status(201).send(review);}).catch(function(error){cov_fkfq7rize.f[3]++;cov_fkfq7rize.s[10]++;return res.status(400).send(error);});},list:function list(req,res){cov_fkfq7rize.f[4]++;cov_fkfq7rize.s[11]++;return Review.findAll({where:{businessId:req.params.businessId}}).then(function(reviews){cov_fkfq7rize.f[5]++;cov_fkfq7rize.s[12]++;return res.status(200).send(reviews);}).catch(function(error){cov_fkfq7rize.f[6]++;cov_fkfq7rize.s[13]++;return res.status(400).send(error);});},update:function update(req,res){cov_fkfq7rize.f[7]++;cov_fkfq7rize.s[14]++;return Review.findById(req.params.reviewId).then(function(review){cov_fkfq7rize.f[8]++;cov_fkfq7rize.s[15]++;if(!review){cov_fkfq7rize.b[4][0]++;cov_fkfq7rize.s[16]++;return res.status(404).send({message:'Review not found'});}else{cov_fkfq7rize.b[4][1]++;}cov_fkfq7rize.s[17]++;if(review.userId!=req.body.userId){cov_fkfq7rize.b[5][0]++;cov_fkfq7rize.s[18]++;return res.status(400).send({message:'User can not be altered'});}else{cov_fkfq7rize.b[5][1]++;}cov_fkfq7rize.s[19]++;if(review.businessId!=req.body.businessId){cov_fkfq7rize.b[6][0]++;cov_fkfq7rize.s[20]++;return res.status(400).send({message:'Business can not be altered'});}else{cov_fkfq7rize.b[6][1]++;}cov_fkfq7rize.s[21]++;return review.update({response:(cov_fkfq7rize.b[7][0]++,req.body.response)||(cov_fkfq7rize.b[7][1]++,review.response),userId:(cov_fkfq7rize.b[8][0]++,req.body.userId)||(cov_fkfq7rize.b[8][1]++,review.userId),businessId:req.params.businessId}).then(function(review){cov_fkfq7rize.f[9]++;cov_fkfq7rize.s[22]++;return res.status(200).send(review);}).catch(function(error){cov_fkfq7rize.f[10]++;cov_fkfq7rize.s[23]++;return res.status(400).send(error);});}).catch(function(error){cov_fkfq7rize.f[11]++;cov_fkfq7rize.s[24]++;return res.status(400).send(error);});},destroy:function destroy(req,res){cov_fkfq7rize.f[12]++;cov_fkfq7rize.s[25]++;return Review.findById(req.params.reviewId).then(function(review){cov_fkfq7rize.f[13]++;cov_fkfq7rize.s[26]++;if(!review){cov_fkfq7rize.b[9][0]++;cov_fkfq7rize.s[27]++;return res.status(404).send({message:'Review not found'});}else{cov_fkfq7rize.b[9][1]++;}cov_fkfq7rize.s[28]++;return review.destroy().then(function(){cov_fkfq7rize.f[14]++;cov_fkfq7rize.s[29]++;return res.status(204).send();}).catch(function(error){cov_fkfq7rize.f[15]++;cov_fkfq7rize.s[30]++;return res.status(400).send(error);});}).catch(function(error){cov_fkfq7rize.f[16]++;cov_fkfq7rize.s[31]++;return res.status(400).send(error);});}});cov_fkfq7rize.s[32]++;exports.default=reviewsController;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldmlld3MuanMiXSwibmFtZXMiOlsiUmV2aWV3IiwibW9kZWwiLCJyZXZpZXdzQ29udHJvbGxlciIsImNyZWF0ZSIsInJlcSIsInJlcyIsImJvZHkiLCJyZXNwb25zZSIsInVzZXJJZCIsImJ1c2luZXNzSWQiLCJzdGF0dXMiLCJzZW5kIiwibWVzc2FnZSIsInBhcmFtcyIsInRoZW4iLCJyZXZpZXciLCJjYXRjaCIsImVycm9yIiwibGlzdCIsImZpbmRBbGwiLCJ3aGVyZSIsInJldmlld3MiLCJ1cGRhdGUiLCJmaW5kQnlJZCIsInJldmlld0lkIiwiZGVzdHJveSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7OztBQUVBLElBQU1BLFNBQVNDLGlCQUFNRCxNQUFyQjs7QUFFQSxJQUFNRSxvQkFBb0I7QUFDeEJDLFFBRHdCLGtCQUNqQkMsR0FEaUIsRUFDWkMsR0FEWSxFQUNQO0FBQ2YsUUFBSSxDQUFDRCxJQUFJRSxJQUFKLENBQVNDLFFBQVYsSUFBc0IsQ0FBQ0gsSUFBSUUsSUFBSixDQUFTRSxNQUFoQyxJQUEwQyxDQUFDSixJQUFJRSxJQUFKLENBQVNHLFVBQXhELEVBQW9FO0FBQ2xFLGFBQU9KLElBQUlLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixFQUFFQyxTQUFTLGtCQUFYLEVBQXJCLENBQVA7QUFDRDs7QUFFRCxXQUFPWixPQUNKRyxNQURJLENBQ0c7QUFDTkksZ0JBQVVILElBQUlFLElBQUosQ0FBU0MsUUFEYjtBQUVOQyxjQUFRSixJQUFJRSxJQUFKLENBQVNFLE1BRlg7QUFHTkMsa0JBQVlMLElBQUlTLE1BQUosQ0FBV0o7QUFIakIsS0FESCxFQU1KSyxJQU5JLENBTUM7QUFBQSxhQUFVVCxJQUFJSyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJJLE1BQXJCLENBQVY7QUFBQSxLQU5ELEVBT0pDLEtBUEksQ0FPRTtBQUFBLGFBQVNYLElBQUlLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFx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O0FBQUEsT0FIRixDQUFQO0FBSUQsS0FWSSxFQVVGRCxLQVZFLENBVUk7QUFBQSxhQUFTWCxJQUFJSyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJNLEtBQXJCLENBQVQ7QUFBQSxLQVZKLENBQVA7QUFXRDtBQXhEdUIsQ0FBMUI7O2tCQTREZWYsaUIiLCJmaWxlIjoicmV2aWV3cy5qcyIsInNvdXJjZVJvb3QiOiIvaG9tZS9zb210by9BbmRlbGEvV2UtQ29ubmVjdC9zZXJ2ZXIvc2VydmVyL2NvbnRyb2xsZXJzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vZGVsIGZyb20gJy4uL21vZGVscyc7XG5cbmNvbnN0IFJldmlldyA9IG1vZGVsLlJldmlldztcblxuY29uc3QgcmV2aWV3c0NvbnRyb2xsZXIgPSB7XG4gIGNyZWF0ZShyZXEsIHJlcykge1xuICAgIGlmICghcmVxLmJvZHkucmVzcG9uc2UgfHwgIXJlcS5ib2R5LnVzZXJJZCB8fCAhcmVxLmJvZHkuYnVzaW5lc3NJZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjA2KS5zZW5kKHsgbWVzc2FnZTogJ0luY29tcGxldGUgZmllbGQnIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBSZXZpZXdcbiAgICAgIC5jcmVhdGUoe1xuICAgICAgICByZXNwb25zZTogcmVxLmJvZHkucmVzcG9uc2UsXG4gICAgICAgIHVzZXJJZDogcmVxLmJvZHkudXNlcklkLFxuICAgICAgICBidXNpbmVzc0lkOiByZXEucGFyYW1zLmJ1c2luZXNzSWQsXG4gICAgICB9KVxuICAgICAgLnRoZW4ocmV2aWV3ID0+IHJlcy5zdGF0dXMoMjAxKS5zZW5kKHJldmlldykpXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpKTtcbiAgfSxcbiAgbGlzdChyZXEsIHJlcykge1xuICAgIHJldHVybiBSZXZpZXdcbiAgICAgIC5maW5kQWxsKHsgd2hlcmU6IHsgYnVzaW5lc3NJZDogcmVxLnBhcmFtcy5idXNpbmVzc0lkIH0gfSlcbiAgICAgIC50aGVuKHJldmlld3MgPT4gcmVzLnN0YXR1cygyMDApLnNlbmQocmV2aWV3cykpXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpKTtcbiAgfSxcbiAgdXBkYXRlKHJlcSwgcmVzKSB7XG4gICAgcmV0dXJuIFJldmlld1xuICAgICAgLmZpbmRCeUlkKHJlcS5wYXJhbXMucmV2aWV3SWQpXG4gICAgICAudGhlbigocmV2aWV3KSA9PiB7XG4gICAgICAgIGlmICghcmV2aWV3KSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHsgbWVzc2FnZTogJ1JldmlldyBub3QgZm91bmQnIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXZpZXcudXNlcklkICE9IHJlcS5ib2R5LnVzZXJJZCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdVc2VyIGNhbiBub3QgYmUgYWx0ZXJlZCcgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJldmlldy5idXNpbmVzc0lkICE9IHJlcS5ib2R5LmJ1c2luZXNzSWQpIHtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBtZXNzYWdlOiAnQnVzaW5lc3MgY2FuIG5vdCBiZSBhbHRlcmVkJyB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV2aWV3XG4gICAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgICByZXNwb25zZTogcmVxLmJvZHkucmVzcG9uc2UgfHwgcmV2aWV3LnJlc3BvbnNlLFxuICAgICAgICAgICAgdXNlcklkOiByZXEuYm9keS51c2VySWQgfHwgcmV2aWV3LnVzZXJJZCxcbiAgICAgICAgICAgIGJ1c2luZXNzSWQ6IHJlcS5wYXJhbXMuYnVzaW5lc3NJZCxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKHJldmlldyA9PiByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXZpZXcpKVxuICAgICAgICAgIC5jYXRjaChlcnJvciA9PiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnJvcikpO1xuICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpKTtcbiAgfSxcbiAgZGVzdHJveShyZXEsIHJlcykge1xuICAgIHJldHVybiBSZXZpZXdcbiAgICAgIC5maW5kQnlJZChyZXEucGFyYW1zLnJldmlld0lkKVxuICAgICAgLnRoZW4oKHJldmlldykgPT4ge1xuICAgICAgICBpZiAoIXJldmlldykge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdSZXZpZXcgbm90IGZvdW5kJyB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV2aWV3XG4gICAgICAgICAgLmRlc3Ryb3koKVxuICAgICAgICAgIC50aGVuKCgpID0+IHJlcy5zdGF0dXMoMjA0KS5zZW5kKCkpXG4gICAgICAgICAgLmNhdGNoKGVycm9yID0+IHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycm9yKSk7XG4gICAgICB9KS5jYXRjaChlcnJvciA9PiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnJvcikpO1xuICB9LFxuXG59O1xuXG5leHBvcnQgZGVmYXVsdCByZXZpZXdzQ29udHJvbGxlcjtcbiJdfQ==